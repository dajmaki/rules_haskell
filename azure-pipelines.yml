jobs:
# - job: Linux
#   pool:
#     vmImage: 'Ubuntu-16.04'
#   steps:
#   - script: |
#       curl https://nixos.org/nix/install | sh
#     displayName: 'Install Nix'
#   - script: |
#       . /home/vsts/.nix-profile/etc/profile.d/nix.sh
#       nix-shell --pure --run 'bazel build //tests:run-tests && ./bazel-bin/tests/run-tests'
#     displayName: 'Build and run tests'
# - task: PublishTestResults@2
#   inputs:
#     testResultsFormat: 'JUnit'
#     testResultsFiles: 'bazel-testlogs/**/test.xml'
- job: Windows
  pool:
    vmImage: 'vs2017-win2016'
  steps:
  - bash: |
      curl -LO https://github.com/bazelbuild/bazel/releases/download/0.20.0/bazel-0.20.0-windows-x86_64.exe
      mv bazel-*.exe bazel.exe
      mkdir /c/bazel
      mv bazel.exe /c/bazel
    displayName: 'Install Bazel'
  - bash: |
      # C:\bazel\bazel.exe test //tests/binary-simple
      /c/bazel/bazel.exe test //tests/binary-simple
    displayName: 'Build and run tests'


